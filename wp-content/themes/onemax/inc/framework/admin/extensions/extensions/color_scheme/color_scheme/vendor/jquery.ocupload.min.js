(function(e){e.fn.upload=function(t){t=e.extend({name:"file","class":"hidden-input-div",enctype:"multipart/form-data",action:"",fileType:"",autoSubmit:true,onSubmit:function(){},onComplete:function(){},onSelect:function(){},params:{}},t);return new e.ocupload(this,t)},e.ocupload=function(t,n){var r=this;var i=(new Date).getTime().toString().substr(8);var s=e("<iframe "+'id="iframe'+i+'" '+'name="iframe'+i+'"'+"></iframe>").css({display:"none"});var o=e("<form "+'method="post" '+'enctype="'+n.enctype+'" '+'action="'+n.action+'" '+'target="iframe'+i+'"'+"></form>").css({margin:0,padding:0});var u=e("<input "+'name="'+n.name+'" '+'type="file" '+'accept="'+n.fileType+'"'+'class="noUpdate"'+"/>").css({position:"relative",display:"block",marginLeft:-175+"px",opacity:0,cursor:"pointer"});t.wrap('<div class="'+n.class+'"></div>');o.append(u);t.after(o);t.after(s);var a=t.parent().css({position:"relative",height:t.outerHeight()+"px",width:t.outerWidth()+"px",overflow:"hidden",cursor:"pointer",margin:0,padding:0});u.css("marginTop",-a.height()-10+"px");a.mousemove(function(e){u.css({top:e.pageY-a.offset().top+"px",left:e.pageX-a.offset().left+"px"})});u.change(function(){r.onSelect();if(r.autoSubmit){r.submit()}});e.extend(this,{autoSubmit:true,onSubmit:n.onSubmit,onComplete:n.onComplete,onSelect:n.onSelect,filename:function(){return u.attr("value")},params:function(t){var t=t?t:false;if(t){n.params=e.extend(n.params,t)}else{return n.params}},name:function(e){var e=e?e:false;if(e){u.attr("name",value)}else{return u.attr("name")}},action:function(e){var e=e?e:false;if(e){o.attr("action",e)}else{return o.attr("action")}},enctype:function(e){var e=e?e:false;if(e){o.attr("enctype",e)}else{return o.attr("enctype")}},set:function(t,n){function i(e,t){switch(e){default:throw new Error("[jQuery.ocupload.set] '"+e+"' is an invalid option.");break;case"name":r.name(t);break;case"action":r.action(t);break;case"enctype":r.enctype(t);break;case"params":r.params(t);break;case"autoSubmit":r.autoSubmit=t;break;case"onSubmit":r.onSubmit=t;break;case"onComplete":r.onComplete=t;break;case"onSelect":r.onSelect=t;break}}var n=n?n:false;if(n){i(t,n)}else{e.each(t,function(e,t){i(e,t)})}},submit:function(){this.onSubmit();e.each(n.params,function(t,n){o.append(e("<input "+'type="hidden" '+'name="'+t+'" '+'value="'+n+'" '+"/>"))});o.submit();s.unbind().load(function(){var t=document.getElementById(s.attr("name"));var n=e(t.contentWindow.document.body).text();r.onComplete(n)})}})}})(jQuery)