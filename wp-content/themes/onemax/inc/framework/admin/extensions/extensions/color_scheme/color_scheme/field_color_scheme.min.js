!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.color_scheme=redux.field_objects.color_scheme||{},redux.field_objects.color_scheme.nonce="",redux.field_objects.color_scheme.fieldID="",redux.field_objects.color_scheme.optName="",redux.field_objects.color_scheme.el="",redux.field_objects.color_scheme.default_params={},redux.field_objects.color_scheme.hexToRGBA=function(e,c){if(null===e)s="";else{e=e.replace("#","");var o=parseInt(e.substring(0,2),16),t=parseInt(e.substring(2,4),16),d=parseInt(e.substring(4,6),16),s="rgba("+o+","+t+","+d+","+c+")"}return s},redux.field_objects.color_scheme.init=function(c){c||(c=e(document).find(".redux-group-tab:visible").find(".redux-container-color_scheme:visible")),e(c).each(function(){var c=e(this),o=c;redux.field_objects.color_scheme.el=c,c.hasClass("redux-field-container")||(o=c.parents(".redux-field-container:first")),o.is(":hidden")||o.hasClass("redux-field-init")&&(o.removeClass("redux-field-init"),redux.field_objects.color_scheme.modInit(c),redux.field_objects.color_scheme.setAccordions(c),redux.field_objects.color_scheme["import"](c),redux.field_objects.color_scheme["delete"](c),redux.field_objects.color_scheme.save(c))})},redux.field_objects.color_scheme.setAccordions=function(c){var o=c.find("ul.redux-scheme-layout"),t=o.data("open-icon"),d=o.data("close-icon"),s=Boolean(c.find(".redux-color-scheme-container").data("accordion"));if(s===!0){var r=c.find(".redux-color-scheme-accordion-section");r.each(function(){var c=Boolean(e(this).data("state"));c===!1?e(this).hide():(e(this).prev(".redux-color-scheme-accordion").find(".el").removeClass(t).addClass(d),redux.field_objects.color_scheme.initColorPicker(e(this)))}),c.find(".redux-color-scheme-accordion").click(function(c){c.preventDefault();var o=e(this).next(".redux-color-scheme-accordion-section");o.is(":visible")?(e(this).find(".el").removeClass(d).addClass(t),o.slideUp()):(e(this).find(".el").removeClass(t).addClass(d),redux.field_objects.color_scheme.initColorPicker(o),o.slideDown())})}else redux.field_objects.color_scheme.initColorPicker(c)},redux.field_objects.color_scheme.modInit=function(c){redux.field_objects.color_scheme.nonce=c.find(".redux-color-scheme-container").data("nonce"),redux.field_objects.color_scheme.fieldID=c.find(".redux-color-scheme-container").data("id"),redux.field_objects.color_scheme.optName=c.find(".redux-color-scheme-container").data("opt-name"),redux.field_objects.color_scheme.default_params={triggerChange:!0,allowClear:!1};var o=c.find(".redux-container-color_scheme").find(".select2_params");if(o.size()>0){var t=o.val();t=JSON.parse(t),redux.field_objects.color_scheme.default_params=e.extend({},redux.field_objects.color_scheme.default_params,t)}c.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),c.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params);var d=Boolean(c.find(".redux-color-scheme-container").data("dev-mode"));if(d===!0){var s=e(".redux-color-scheme-container").data("version"),r=e("div.redux-timer").html();void 0!==r&&e("div.redux-timer").html(r+"<br/>Color Scheme extension v."+s)}c.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).click(function(e){this.focus(),this.select(),e.preventDefault()}),c.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).val(c.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).val()),c.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).on("change",function(){redux.field_objects.color_scheme.selectChange(c)})},redux.field_objects.color_scheme["import"]=function(c){var o=redux.field_objects.color_scheme.fieldID,t=redux.field_objects.color_scheme.optName,d=c.find("#redux-"+o+"-import-scheme-button"),s=c.find("#redux-"+o+"-import-scheme-button").data("submit");d.upload({name:"file",method:"post",action:s+"attachment.php",enctype:"multipart/form-data",fileType:".json",params:{type:"import",field_id:o,opt_name:t},autoSubmit:!0,onSubmit:function(){},onComplete:function(t){t=JSON.parse(t),c.find("#redux-"+o+"-scheme-message-notice h2").html(t.data),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),!0===t.result&&(window.onbeforeunload="",location.reload()),!1})},onSelect:function(){}})},redux.field_objects.color_scheme["delete"]=function(c){var o=redux.field_objects.color_scheme.fieldID;c.find("#redux-"+o+"-delete-scheme-button").click(function(t){t.preventDefault();var d=c.find("#redux-scheme-select-"+o).val();return"default"===d.toLowerCase()?(c.find("#redux-"+o+"-scheme-message-notice h2").html("Cannot delete the <strong>Default</strong> scheme, as it is reserved."),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),!1}),!1):(e.blockUI({message:c.find("#redux-"+o+"-delete-scheme-question"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-delete-scheme-yes").click(function(){if(d){var t={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"delete",scheme_id:d,field_id:o},s=c.find("#redux-"+o+"-scheme-wait-message h1").html();e.blockUI({message:"<h1>"+s+"deleting scheme.<h1/>",theme:!1,css:{width:"500px",padding:"5px"}}),e.post(redux_ajax_script.ajaxurl,t,function(t){"success"===t?(c.find("#redux-scheme-select-"+o+" option[value='"+d+"']").remove(),c.find(".redux-scheme-select").select2("val","Default"),c.find("input.redux-scheme-input-"+o).val(""),c.find("#redux-"+o+"-scheme-message-notice h2").html("The <strong>"+d+"</strong> scheme has been removed.<br/><br/>The color table has been reset to default values."),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),redux.field_objects.color_scheme.updateSchemeHTML(0,c),!1})):(c.find("#redux-"+o+"-scheme-message-notice h2").html("Delete failed: "+t),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),!1}))})}}),void e("#redux-"+o+"-delete-scheme-no").click(function(){return e.unblockUI(),!1}))})},redux.field_objects.color_scheme.save=function(c){var o=redux.field_objects.color_scheme.fieldID;c.find("#redux-"+o+"-save-scheme-button").click(function(t){t.preventDefault();var d=c.find("input.redux-scheme-input-"+o).val();if(d=d.replace(/^\s+|\s+$/gm,""),d=d.replace(/[^a-z0-9\s\_\-]/gi,""),""===d)return!1;if("default"===d.toLowerCase())return c.find("#redux-"+o+"-scheme-message-notice h2").html("The name <strong>Default</strong> cannot be used as it is reserved."),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),!1}),!1;var s=[];c.find(".redux-scheme-layout-container").each(function(){var c=e(this).children(".redux-color-scheme"),o=c.data("title"),t=c.data("id"),d=c.data("hex-color"),r=c.data("alpha"),a=c.data("rgba"),l=c.data("selector"),i=c.data("mode"),n=c.data("important"),u=c.data("group");s.push({id:t,title:o,color:d,alpha:r,rgba:a,selector:l,mode:i,important:n,group:u})}),s=JSON.stringify(s),s=encodeURIComponent(s);var r=c.find(".redux-scheme-input-"+o).val();if(r){var a={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"save",scheme_name:r,scheme_data:s,field_id:o},l=c.find("#redux-"+o+"-scheme-wait-message h1").html();e.blockUI({message:"<h1>"+l+"saving scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}}),c.find(".redux-scheme-select").select2("destroy"),e.post(redux_ajax_script.ajaxurl,a,function(t){c.find("#redux-scheme-select-"+o).on("change",function(){redux.field_objects.color_scheme.selectChange(c)}),"fail"===t?c.find("#redux-"+o+"-scheme-message-notice h2").html("The scheme <strong>"+r+"</strong> already exists and cannot be added again."):(c.find("#redux-scheme-select-"+o).replaceWith(t),c.find("#redux-"+o+"-scheme-message-notice h2").html("The scheme <strong>"+r+"</strong> has been added to your scheme list.")),e.blockUI({message:c.find("#redux-"+o+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),e("#redux-"+o+"-scheme-ok").click(function(){return e.unblockUI(),!1}),c.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),c.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params)})}})},redux.field_objects.color_scheme.selectChange=function(e){var c=redux.field_objects.color_scheme.fieldID;e.find("ul.redux-scheme-layout").fadeOut();var o=e.find("#redux-scheme-select-"+c).val();e.find("#redux-scheme-select-"+c+" option[value='']").remove(),e.find("input.redux-scheme-input-"+c).val(o),redux.field_objects.color_scheme.updateSchemeHTML(o,e)},redux.field_objects.color_scheme.updateSchemeHTML=function(c,o){var t=redux.field_objects.color_scheme.fieldID,d=o.find("#redux-"+t+"-scheme-wait-message h1").html();e.blockUI({message:"<h1>"+d+"updating scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}});var s=o.find(".redux-color-scheme").attr("class"),r={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"update",scheme_id:c,field_id:t,field_class:s};e.post(redux_ajax_script.ajaxurl,r,function(c){o.find("ul.redux-scheme-layout").replaceWith(c),redux.field_objects.color_scheme.setAccordions(o),o.find("ul.redux-scheme-layout").fadeIn(),e.unblockUI(),redux_change(o.find(".redux-color-scheme-container")),o.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params)})},redux.field_objects.color_scheme.initColorPicker=function(c){var o=redux.field_objects.color_scheme.fieldID,t=c.find(".redux-color-scheme"),d=t.data("current-alpha");d=Number(null===d||void 0===d?1:d);var s=t.data("current-color");s=""===s||"transparent"===s?"":s;var r=t.data("output-transparent");r=Boolean(""===r?!1:r);var a=redux.field_objects.color_scheme.el.find(".redux-color-scheme-container"),l=a.data("palette");l=decodeURIComponent(l),l=JSON.parse(l),null===l&&(l=[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d9ead3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]);var i=a.data("picker-gap");i=String(""===i?"60px":i);var n=a.data("picker-font-size");n=String(""===n?"11px":n);var u=a.data("show-input");u=Boolean(""===u?!1:u);var f=a.data("show-initial");f=Boolean(""===f?!1:f);var h=a.data("show-alpha");h=Boolean(""===h?!1:h);var m=a.data("allow-empty");m=Boolean(""===m?!1:m);var x=a.data("show-palette");x=Boolean(""===x?!1:x);var _=a.data("show-palette-only");_=Boolean(""===_?!1:_);var p=a.data("show-selection-palette");p=Boolean(""===p?!1:p);var b=Number(a.data("max-palette-size")),v=a.data("clickout-fires-change");v=Boolean(""===v?!1:v);var g=String(a.data("choose-text")),j=String(a.data("cancel-text")),k=a.data("show-buttons");k=Boolean(""===k?!1:k);var I=String(a.data("container-class")),w=String(a.data("replacer-class"));c.find("li.redux-scheme-layout").css("width",i),c.find(".redux-layout-label").attr("style","font-size: "+n+"!important"),t.spectrum({color:s,showAlpha:h,showInput:u,allowEmpty:m,className:"redux-full-spectrum",showInitial:f,showPalette:x,showSelectionPalette:p,maxPaletteSize:b,showPaletteOnly:_,clickoutFiresChange:v,chooseText:g,cancelText:j,showButtons:k,containerClassName:I,replacerClassName:w,preferredFormat:"hex6",localStorageKey:"redux.spectrum."+o,palette:l,change:function(o){var t,d,s;null===o?(t=r===!0?"transparent":null,d=null):(t=o.toHexString(),d=o.alpha),s="transparent"!=t?redux.field_objects.color_scheme.hexToRGBA(t,d):"transparent";var a=e(this).data("block-id"),l=c.find("input#"+a+"-data"),i=l.val();i=decodeURIComponent(i),i=JSON.parse(i),i.color=t,i.alpha=d,i.rgba=s,i=JSON.stringify(i),i=encodeURIComponent(i),l.val(i),redux_change(redux.field_objects.color_scheme.el.find(".redux-color-scheme-container"))}})}}(jQuery);